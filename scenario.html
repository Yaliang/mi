<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1user-scalable=no"> <meta name="apple-mobile-web-app-capable" content="yes"> <meta name="apple-mobile-web-app-status-bar-style" content="black"> <meta name="mobile-web-app-capable" content="yes"> <title>scenario</title> <link rel="icon" sizes="192x192" href="./content/material-design/png/m-192.png"> <link rel="apple-touch-icon" href="./content/material-design/png/m-192.png"> <script src="./script/jquery/jquery-1.11.1.min.js"></script><script src="./script/parse/parse-1.3.2.min.js"></script><link rel="stylesheet" href="./script/bootstrap/bootstrap-3.3.5-dist/css/bootstrap.min.css">  <script src="./script/bootstrap/bootstrap-3.3.5-dist/js/bootstrap.min.js"></script><link rel="stylesheet" href="./scenario.css"> </head> <body> <div class="navbar-wrapper"> <div class="container"> <nav class="navbar navbar-inverse navbar-static-top"> <div class="container"> <div class="navbar-header"> <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> <a class="navbar-brand" href="#">Scenario</a> </div> <div id="navbar" class="navbar-collapse collapse"> <ul class="nav navbar-nav navbar-right"> <li><a class="navbar-login" href="#">Unsigned in</a></li> </ul> </div> </div> </nav> </div> </div> <div class="container" id="introduction"> <hr class="featurette-divider"> <h2>众包应用设计</h2> <h4><small>程序员哥哥是个十分注重生活品质的人，空余时间喜欢出去玩桌游，吃好吃的等等等等，但有时候实在约不到人，于是想到不如写个应用专门做基于活动的陌生人社交。想到现在用户体验那么重要，用众包的形式来设计应用会比较有效。既然众包，那么每个用户都能成为应用的设计者，所以也想听听使用者们的想法。大家觉得基于活动的陌生人社交应用场景会有哪些呢？</small></h4> <h4><small>你可以在这里提交你设计的应用场景，也可以浏览别人的场景设计并投票，程序员哥哥写了一些代码用来分发一个随机的身份，只要不是隐身模式，每次从相同浏览器打开页面，都能够追踪到你的记录。积极参与的使用者将有机会得到程序员哥哥送出的 Amazon Gift Card，欢迎参与呀~</small></h4> <h4><small>有什么问题请给程序员哥哥Email: yaliangwang2015@u.northwestern.edu</small></h4> <button type="button" class="btn btn-primary btn-margin" id="browser-scenarios">Browser Scenarios</button> <button type="button" class="btn btn-success btn-margin" id="open-new-scenario">Create new Scenario</button> <button type="button" class="btn btn-default btn-margin" id="my-scenario">My Scenarios</button> <hr class="featurette-divider"> </div> <div class="container hidden" id="list-scenario"> <hr class="featurette-divider"> <button type="button" class="btn btn-success btn-margin hidden" id="open-new-scenario-2">Whoops! No more Scenario! Create a new Scenario</button> <hr id="list-bottom"> </div> <div class="container hidden" id="new-scenario"> <hr class="featurette-divider"> <form class="form-horizontal form-body"> <div class="form-group"> <label for="inputname" class="col-sm-2 control-label">主人公名称</label> <div class="col-sm-10"> <input class="form-control" id="inputname" aria-describedby="inputnameStatus" placeholder="name"> <span class="glyphicon glyphicon-remove form-control-feedback hidden" aria-hidden="true"></span> <span id="inputnameStatus" class="sr-only hidden">(required)</span> </div> </div> <div class="form-group"> <label for="inputgender" class="col-sm-2 control-label">性别</label> <div class="col-sm-10"> <input class="form-control" id="inputgender" aria-describedby="inputgenderStatus" placeholder="gender"> <span class="glyphicon glyphicon-remove form-control-feedback hidden" aria-hidden="true"></span> <span id="inputgenderStatus" class="sr-only hidden">(required)</span> </div> </div> <div class="form-group"> <label for="inputage" class="col-sm-2 control-label">年龄</label> <div class="col-sm-10"> <input class="form-control" id="inputage" aria-describedby="inputageStatus" placeholder="age"> <span class="glyphicon glyphicon-remove form-control-feedback hidden" aria-hidden="true"></span> <span id="inputageStatus" class="sr-only hidden">(required)</span> </div> </div> <div class="form-group"> <label for="inputinterest" class="col-sm-2 control-label">爱好</label> <div class="col-sm-10"> <input class="form-control" id="inputinterest" aria-describedby="inputinterestStatus" placeholder="interests"> <span class="glyphicon glyphicon-remove form-control-feedback hidden" aria-hidden="true"></span> <span id="inputinterestStatus" class="sr-only hidden">(required)</span> </div> </div> <div class="form-group"> <label for="inputcircle" class="col-sm-2 control-label">圈子</label> <div class="col-sm-10"> <input class="form-control" id="inputcircle" aria-describedby="inputcircleStatus" placeholder="circle"> <span class="glyphicon glyphicon-remove form-control-feedback hidden" aria-hidden="true"></span> <span id="inputcircleStatus" class="sr-only hidden">(required)</span> </div> </div> <div class="form-group"> <label for="inputtarget" class="col-sm-2 control-label">目标</label> <div class="col-sm-10"> <input class="form-control" id="inputtarget" aria-describedby="inputtargetStatus" placeholder="target"> <span class="glyphicon glyphicon-remove form-control-feedback hidden" aria-hidden="true"></span> <span id="inputtargetStatus" class="sr-only hidden">(required)</span> </div> </div> <div class="form-group"> <label for="inputscenario" class="col-sm-2 control-label">应用情景</label> <div class="col-sm-10"> <textarea class="form-control" id="inputscenario" rows="4" aria-describedby="inputscenarioStatus" placeholder="Scenario"></textarea> <span class="glyphicon glyphicon-remove form-control-feedback hidden" aria-hidden="true"></span> <span id="inputscenarioStatus" class="sr-only hidden">(required)</span> </div> </div> <div class="form-group"> <div class="col-sm-offset-2 col-sm-10"> <button type="button" class="btn btn-primary" id="form-submit">Submit</button> <button type="button" class="btn btn-default" id="form-cancel">Cancel</button> </div> </div> </form> </div> <script>Parse.initialize("wb1H99PhI78oFUQPzGPtPVj8rgna6KRTYwoKc9wJ","sQz8t99tZ0FbUzVkFmZpFY8EB2vnP8xLkP9B8j6T"),parse={signup:function(e){if("user"in localStorage){var n=JSON.parse(localStorage.user);Parse.User.logIn(n.username,n.password,{success:function(n){"success"in e&&e.success(n)},error:function(n,s){"error"in e&&e.error(n,s),console.log("Error: "+s.code+" "+s.message)}})}else{var s=new Parse.User,r=Math.random().toString(),i=Math.random().toString();localStorage.user=JSON.stringify({username:r,password:i}),s.set("username",r),s.set("password",i),s.set("times",1),s.signUp(null,{success:function(n){"success"in e&&e.success(n)},error:function(n,s){"error"in e&&e.error(n,s),console.log("Error: "+s.code+" "+s.message)}})}},login:function(e){if("user"in localStorage){var n=JSON.parse(localStorage.user);console.log(n.username+" "+n.password),Parse.User.logIn(n.username,n.password,{success:function(n){n.increment("times",1),n.save(null,{success:function(n){"success"in e&&e.success(n)},error:function(n,s){"error"in e&&e.error(n,s),console.log("Error: "+s.code+" "+s.message)}})},error:function(n,s){"error"in e&&e.error(n,s),console.log("Error: "+s.code+" "+s.message)}})}else parse.signup(e)},logout:function(){Parse.User.logOut()},getpost:function(e){var n=Parse.Object.extend("Post"),s=new Parse.Query(n);s.get(e.id,{success:function(n){"success"in e&&e.success(n)},error:function(n,s){"error"in e&&e.error(n,s),console.log("Error: "+s.code+" "+s.message)}})},toppost:function(e){var n=Parse.Object.extend("LikeCounter"),s=new Parse.Query(n),r=10;"limit"in e&&(r=e.limit),"createdBy"in e&&s.equalTo("createdBy",Parse.User.current()),s.limit(r),"skip"in e&&s.skip(e.skip),s.descending("likeNum"),s.find({success:function(n){"success"in e&&e.success(n)},error:function(n,s){"error"in e&&e.error(n,s),console.log("Error: "+s.code+" "+s.message)}})},addpost:function(e){"button"in e&&e.button.html("Submitting");var n=Parse.Object.extend("Post"),s=new n,r=new Parse.ACL;r.setPublicReadAccess(!0),r.setWriteAccess(Parse.User.current().id,!0),s.set("createdBy",Parse.User.current()),s.set("name",e.name),s.set("gender",e.gender),s.set("age",e.age),s.set("interest",e.interest),s.set("circle",e.circle),s.set("target",e.target),s.set("scenario",e.scenario),s.setACL(r),s.save(null,{success:function(n){e.post=n,"button"in e&&e.button.html("Creating");var s=Parse.Object.extend("LikeCounter"),r=new s;r.set("post",n),r.set("like",[]),r.set("dislike",[]),r.set("createdBy",Parse.User.current()),r.save(null,{success:function(n){e.likeCounter=n,"button"in e&&e.button.html("Binding"),e.post.set("likeCounter",n),e.post.save(null,{success:function(n){e.post=n,"success"in e&&e.success(n)},error:function(n,s){"error"in e&&e.error(n,s),console.log("Error: "+s.code+" "+s.message)}})},error:function(n){"error"in e&&e.error(n,error),console.log("Error: "+error.code+" "+error.message)}})},error:function(n,s){"error"in e&&e.error(n,s),console.log("Error: "+s.code+" "+s.message)}})},editpost:function(e){var n=Parse.Object.extend("Post"),s=new Parse.Query(n);s.get(e.postid,{success:function(n){n.set("name",e.name),n.set("gender",e.gender),n.set("age",e.age),n.set("interest",e.interest),n.set("circle",e.circle),n.set("target",e.target),n.set("scenario",e.scenario),n.save(null,{success:function(n){"success"in e&&e.success(n)},error:function(n,s){"error"in e&&e.error(n,s),console.log("Error: "+s.code+" "+s.message)}})}})},likepost:function(e){var n=Parse.Object.extend("LikeCounter"),s=new Parse.Query(n);s.get(e.likeid,{success:function(n){n.addUnique("like",Parse.User.current().id),n.remove("dislike",Parse.User.current().id),n.save(null,{success:function(n){"success"in e&&e.success(n)},error:function(n,s){"error"in e&&e.error(n,s),console.log("Error: "+s.code+" "+s.message)}})},error:function(n,s){"error"in e&&e.error(n,s),console.log("Error: "+s.code+" "+s.message)}})},dislikepost:function(e){var n=Parse.Object.extend("LikeCounter"),s=new Parse.Query(n);s.get(e.likeid,{success:function(n){n.addUnique("dislike",Parse.User.current().id),n.remove("like",Parse.User.current().id),n.save(null,{success:function(n){"success"in e&&e.success(n)},error:function(n,s){"error"in e&&e.error(n,s),console.log("Error: "+s.code+" "+s.message)}})},error:function(n,s){"error"in e&&e.error(n,s),console.log("Error: "+s.code+" "+s.message)}})}},form={init:function(e){"undefined"==typeof e&&($("#new-scenario").removeClass("hidden"),$("#introduction").addClass("hidden"),$("#list-scenario").addClass("hidden"))},check:function(){for(var e=["#inputname","#inputgender","#inputage","#inputinterest","#inputcircle","#inputtarget","#inputscenario"],n=0;n<e.length;n++){var s=e[n],r=$(s).val();if(0==r.length)return $(s).parent().parent().addClass("has-error has-feedback"),$(s).next().removeClass("hidden"),$(s).next().next().removeClass("hidden"),$(s).keyup(function(){$(s).parent().parent().removeClass("has-error has-feedback"),$(s).next().addClass("hidden"),$(s).next().addClass("hidden"),$(s).unbind("keyup")}),!1}return!0},submit:function(){if(!this.check())return!1;var e={};e.name=$("#inputname").val(),e.gender=$("#inputgender").val(),e.age=$("#inputage").val(),e.interest=$("#inputinterest").val(),e.circle=$("#inputcircle").val(),e.target=$("#inputtarget").val(),e.scenario=$("#inputscenario").val(),e.success=function(){$("#form-submit").html("Submitted"),setTimeout(function(){form.blocking=!1,form.clear(),form.cancel()},2e3)},e.error=function(){form.blocking=!1},e.button=$("#form-submit"),form.blocking=!0,parse.addpost(e)},cancel:function(){$("#new-scenario").addClass("hidden"),$("#introduction").removeClass("hidden")},clear:function(){for(var e=["#inputname","#inputgender","#inputage","#inputinterest","#inputcircle","#inputtarget","#inputscenario"],n=0;n<e.length;n++){var s=e[n];$(s).val(""),$(s).parent().parent().removeClass("has-error has-feedback"),$(s).next().addClass("hidden"),$(s).next().addClass("hidden"),$(s).unbind("keyup")}$("#form-submit").html("Submit")}},list={init:function(e){window.history.pushState(null,"scenario","#scenario-list"),window.onpopstate=function(e){list.back()},list.blocking=0,list.skipNum=0,$("#list-scenario").removeClass("hidden"),$("#new-scenario").addClass("hidden"),$("#introduction").addClass("hidden"),$("#open-new-scenario-2").addClass("hidden"),$("#list-scenario").html("<hr class='featurette-divider'><div id='list-bottom'><button type='button' class='btn btn-success btn-margin hidden' id='open-new-scenario-2'>Whoops! No more Scenario! Create a new Scenario</button><hr></div>"),$("#open-new-scenario-2").click(function(){list.back(),form.init()}),$(window).unbind("scroll"),$(window).scroll(function(){var n=($("#list-scenario"),$(document).height()-$(document).scrollTop()-$(window).height());100>n&&list.listBuild(e)})},itemBuild:function(e){var n="#list-media-"+e.get("post").id;if(0==$(n).length){var s="<div class='media' id='list-media-"+e.get("post").id+"'></div><hr>";$("#list-bottom").before(s)}else $(n).html("");var r=e.id,i=(e.get("post").id,e.get("like")),t=e.get("dislike"),o=i.length,c=t.length;$(n).append("<div class='media-left'></div>"),$(n).append("<div class='media-body'>loading...</div>"),$(n+" > .media-left").append("<button class='btn btn-success' type='button'><span class='glyphicon glyphicon-chevron-up' aria-hidden='true'></span><span class='badge'>"+o+"</span></button>"),$(n+" > .media-left").append("<button class='btn btn-margin' type='button'><span class='glyphicon glyphicon-chevron-down' aria-hidden='true'></span><span class='badge'>"+c+"</span></button>"),-1==jQuery.inArray(Parse.User.current().id,i)?$(n+" > .media-left > .btn-success").bind("click",{likeid:r},function(e){if(list.blocking>0)return!1;var n=e.data;console.log("top it: "+n.likeid),list.blocking+=1,parse.likepost({likeid:n.likeid,success:function(e){list.itemBuild(e)}})}):$(n+" > .media-left > .btn-success").removeClass("btn-success").addClass("btn-primary"),-1==jQuery.inArray(Parse.User.current().id,t)?$(n+" > .media-left > .btn-margin").bind("click",{likeid:r},function(e){if(list.blocking>0)return!1;var n=e.data;console.log("bottom it: "+n.likeid),list.blocking+=1,parse.dislikepost({likeid:n.likeid,success:function(e){list.itemBuild(e)}})}):$(n+" > .media-left > .btn-margin").addClass("btn-primary");var a={};a.id=e.get("post").id,a.success=function(e){var n="#list-media-"+e.id,s="<small><strong>姓名:</strong> "+e.get("name")+"</br><strong>性别:</strong> "+e.get("gender")+"</br><strong>年龄:</strong> "+e.get("age")+"</br><strong>兴趣:</strong> "+e.get("interest")+"</br><strong>圈子:</strong> "+e.get("circle")+"</br><strong>目标:</strong> "+e.get("target")+"</br><strong>情境:</strong> "+e.get("scenario").replace("\n","</br>")+"</small>";$(n+" > .media-body").html(s),list.blocking-=1},a.error=function(){list.blocking-=1},parse.getpost(a)},listBuild:function(e){if(list.blocking>0)return!1;list.blocking=1;var n={limit:10};"limit"in e&&(n.limit=e.limit),"createdBy"in e&&(n.createdBy=e.createdBy),"skipNum"in list&&(n.skip=list.skipNum),n.success=function(e){"skipNum"in list?list.skipNum+=e.length:list.skipNum=e.length,0==e.length&&(console.log("No more"),$("#open-new-scenario-2").removeClass("hidden")),list.blocking=e.length;for(var n=0;n<e.length;n++)list.itemBuild(e[n])},parse.toppost(n)},back:function(){$("#list-scenario").addClass("hidden"),$("#new-scenario").addClass("hidden"),$("#introduction").removeClass("hidden"),$("#list-scenario").unbind("scroll")}},eventBinder={init:function(){$("#browser-scenarios").unbind("click"),$("#browser-scenarios").click(function(){list.init({limit:10}),list.listBuild({limit:10})}),$("#my-scenario").unbind("click"),$("#my-scenario").click(function(){list.init({limit:10,createdBy:Parse.User.current()}),list.listBuild({limit:10,createdBy:Parse.User.current()})}),$("#open-new-scenario").unbind("click"),$("#open-new-scenario").click(function(){form.init()}),$("#form-submit").unbind("click"),$("#form-submit").click(function(){return form.blocking?!1:void form.submit()}),$("#form-cancel").unbind("click"),$("#form-cancel").click(function(){return form.blocking?!1:(form.clear(),void form.cancel())})}},user={init:function(){"user"in localStorage?(console.log("has user setup"),parse.login({success:function(e){console.log("logged in"),$(".navbar-login").html("Signed in"),e.signed=!0,eventBinder.init()}})):(console.log("no user setup"),parse.signup({success:function(e){console.log("logged in"),$(".navbar-login").html("Signed in"),e.signed=!0,eventBinder.init()}}))}},app={version:"0.1.3",init:function(){"appversion"in localStorage&&localStorage.appversion==app.version||(localStorage.removeItem("user"),parse.logout(),localStorage.appversion=app.version),user.init()}},app.init();</script></body></html>